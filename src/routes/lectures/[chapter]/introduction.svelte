<script lang="ts">
  import NoteBox from '$lib/components/NoteBox.svelte';
  import CodeExample from '$lib/components/CodeExample.svelte';
  import InteractivePlayground from '$lib/components/InteractivePlayground.svelte';
  import type { Note, CodeExample as CodeExampleType } from '$lib/types/algebra';
  
  const setDefinition: Note = {
    id: 'intro-set',
    type: 'definition',
    title: 'ì§‘í•© (Set)',
    content: `
      ì§‘í•©ì€ ëª…í™•íˆ ì •ì˜ëœ ëŒ€ìƒë“¤(ì›ì†Œ)ì˜ ëª¨ì„ì…ë‹ˆë‹¤.<br><br>
      
      <strong>ìˆ˜í•™ì  í‘œê¸°:</strong><br>
      â€¢ S = {1, 2, 3} (ìœ í•œ ì§‘í•©)<br>
      â€¢ â„• = {0, 1, 2, 3, ...} (ìì—°ìˆ˜ ì§‘í•©)<br>
      â€¢ a âˆˆ S (aëŠ” Sì˜ ì›ì†Œ)<br><br>
      
      <strong>íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì—ì„œ:</strong><br>
      ì§‘í•©ì€ <strong>íƒ€ì…(Type)</strong>ìœ¼ë¡œ í‘œí˜„ë©ë‹ˆë‹¤!
    `
  };
  
  const whyTypeScript: Note = {
    id: 'intro-typescript',
    type: 'tip',
    title: 'ì™œ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¡œ ë°°ìš°ëŠ”ê°€?',
    content: `
      íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì˜ íƒ€ì… ì‹œìŠ¤í…œì€ ëŒ€ìˆ˜ì  êµ¬ì¡°ë¥¼ í‘œí˜„í•˜ê¸°ì— ë§¤ìš° ì í•©í•©ë‹ˆë‹¤:<br><br>
      
      â€¢ <strong>ì§‘í•© â†’ íƒ€ì…</strong>: number, string, boolean<br>
      â€¢ <strong>ì—°ì‚° â†’ í•¨ìˆ˜</strong>: (a: T, b: T) => T<br>
      â€¢ <strong>ê³µë¦¬ â†’ í…ŒìŠ¤íŠ¸</strong>: ê²°í•©ë²•ì¹™, í•­ë“±ì› ê²€ì¦<br>
      â€¢ <strong>ì¸í„°í˜ì´ìŠ¤</strong>: êµ¬ì¡°ì˜ ìš”êµ¬ì‚¬í•­ ëª…ì‹œ
    `
  };
  
  const setExample: CodeExampleType = {
    id: 'intro-sets',
    title: 'íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì§‘í•© í‘œí˜„í•˜ê¸°',
    language: 'typescript',
    runnable: false,
    code: `// ê¸°ë³¸ íƒ€ì…ë“¤ = ë¬´í•œ ì§‘í•©
type Numbers = number;        // ëª¨ë“  ìˆ«ì: {..., -1, 0, 1, 2, ...}
type Strings = string;        // ëª¨ë“  ë¬¸ìì—´: {"", "a", "hello", ...}
type Booleans = boolean;      // {true, false}

// ë¦¬í„°ëŸ´ íƒ€ì… = ìœ í•œ ì§‘í•©
type Digits = 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9;
type Colors = "red" | "green" | "blue";
type Grade = "A" | "B" | "C" | "D" | "F";

// ì§‘í•©ì˜ ì›ì†Œë“¤
const myNumber: Numbers = 42;     // 42 âˆˆ Numbers
const myColor: Colors = "red";    // "red" âˆˆ Colors
const myGrade: Grade = "A";       // "A" âˆˆ Grade

// ì§‘í•©ì˜ í¬ê¸°(Cardinality)
// |Booleans| = 2
// |Digits| = 10
// |Colors| = 3`,
    output: `ì§‘í•©ì˜ ê°œë…ì´ íƒ€ì…ìœ¼ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ í‘œí˜„ë©ë‹ˆë‹¤!`
  };
  
  const operationExample: CodeExampleType = {
    id: 'intro-operations',
    title: 'ì´í•­ ì—°ì‚° (Binary Operation)',
    language: 'typescript',
    runnable: false,
    code: `// ì´í•­ ì—°ì‚°: ë‘ ì›ì†Œë¥¼ ë°›ì•„ í•˜ë‚˜ì˜ ì›ì†Œë¥¼ ë°˜í™˜
// ìˆ˜í•™ì ìœ¼ë¡œ: â€¢ : S Ã— S â†’ S

type BinaryOperation<T> = (a: T, b: T) => T;

// ìˆ«ì ì§‘í•©ì˜ ì—°ì‚°ë“¤
const add: BinaryOperation<number> = (a, b) => a + b;
const multiply: BinaryOperation<number> = (a, b) => a * b;
const max: BinaryOperation<number> = (a, b) => Math.max(a, b);

// ë¬¸ìì—´ ì§‘í•©ì˜ ì—°ì‚°ë“¤
const concat: BinaryOperation<string> = (a, b) => a + b;
const longer: BinaryOperation<string> = (a, b) => 
  a.length >= b.length ? a : b;

// ë¶ˆë¦° ì§‘í•©ì˜ ì—°ì‚°ë“¤
const and: BinaryOperation<boolean> = (a, b) => a && b;
const or: BinaryOperation<boolean> = (a, b) => a || b;

// ì‚¬ìš© ì˜ˆì‹œ
console.log(add(3, 5));           // 8
console.log(concat("hello", " world"));  // "hello world"
console.log(and(true, false));   // false`,
    output: `8
hello world
false`
  };
  
  const closureNote: Note = {
    id: 'intro-closure',
    type: 'definition',
    title: 'ë‹«í˜€ìˆìŒ (Closure)',
    content: `
      ì§‘í•© Sì˜ ì´í•­ ì—°ì‚° â€¢ê°€ <strong>ë‹«í˜€ìˆë‹¤</strong>ëŠ” ê²ƒì€:<br>
      Sì˜ ì„ì˜ì˜ ë‘ ì›ì†Œë¥¼ ì—°ì‚°í•œ ê²°ê³¼ë„ ë°˜ë“œì‹œ Sì— ì†í•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.<br><br>
      
      <strong>ìˆ˜í•™ì  í‘œí˜„:</strong> âˆ€a, b âˆˆ S : a â€¢ b âˆˆ S<br><br>
      
      <strong>íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì—ì„œ:</strong><br>
      í•¨ìˆ˜ì˜ ë°˜í™˜ íƒ€ì…ì´ ì…ë ¥ íƒ€ì…ê³¼ ê°™ìœ¼ë©´ ìë™ìœ¼ë¡œ ë‹«í˜€ìˆìŒì´ ë³´ì¥ë©ë‹ˆë‹¤!<br>
      <code>(a: T, b: T) => T</code>
    `
  };
  
  const closureExample: CodeExampleType = {
    id: 'intro-closure-example',
    title: 'ë‹«í˜€ìˆìŒì˜ ì˜ˆì‹œ',
    language: 'typescript',
    runnable: false,
    code: `// âœ… ë‹«í˜€ìˆëŠ” ì—°ì‚°ë“¤
const addNumbers: (a: number, b: number) => number = (a, b) => a + b;
// ì–´ë–¤ ë‘ ìˆ«ìë¥¼ ë”í•´ë„ ê²°ê³¼ëŠ” ìˆ«ì

const concatStrings: (a: string, b: string) => string = (a, b) => a + b;
// ì–´ë–¤ ë‘ ë¬¸ìì—´ì„ ì—°ê²°í•´ë„ ê²°ê³¼ëŠ” ë¬¸ìì—´

const andBooleans: (a: boolean, b: boolean) => boolean = (a, b) => a && b;
// ì–´ë–¤ ë‘ ë¶ˆë¦°ê°’ì„ ANDí•´ë„ ê²°ê³¼ëŠ” ë¶ˆë¦°ê°’

// âŒ ë‹«í˜€ìˆì§€ ì•Šì€ ì—°ì‚°ë“¤ (íƒ€ì… ì—ëŸ¬ ë°œìƒ!)
// const badOperation: (a: number, b: number) => string = (a, b) => a + b;
//                                              ~~~~~~ íƒ€ì… ì—ëŸ¬!

// ìì—°ìˆ˜ì—ì„œ ëº„ì…ˆì€ ë‹«í˜€ìˆì§€ ì•ŠìŒ (ìŒìˆ˜ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆìŒ)
type NaturalNumber = 0 | 1 | 2 | 3 | 4 | 5; // {0, 1, 2, 3, 4, 5}

// ì´ í•¨ìˆ˜ëŠ” íƒ€ì…ì ìœ¼ë¡œëŠ” ì˜¬ë°”ë¥´ì§€ë§Œ ìˆ˜í•™ì ìœ¼ë¡œëŠ” í‹€ë¦¼
const subtract: (a: NaturalNumber, b: NaturalNumber) => NaturalNumber = 
  (a, b) => (a - b) as NaturalNumber; // ê°•ì œ íƒ€ì… ìºìŠ¤íŒ…

// ì˜ˆ: subtract(2, 5) = -3 (ìì—°ìˆ˜ê°€ ì•„ë‹˜!)`,
    output: `íƒ€ì… ì‹œìŠ¤í…œì´ ë‹«í˜€ìˆìŒì„ ìì—°ìŠ¤ëŸ½ê²Œ ë³´ì¥í•´ì¤ë‹ˆë‹¤!`
  };

  const algebraicStructureNote: Note = {
    id: 'intro-algebraic',
    type: 'tip',
    title: 'ëŒ€ìˆ˜ì  êµ¬ì¡°ë¡œì˜ ì—¬ì •',
    content: `
      ì´ì œ ì§‘í•©ê³¼ ì—°ì‚°ì˜ ê¸°ë³¸ì„ ì´í•´í–ˆìœ¼ë‹ˆ, ë³¸ê²©ì ì¸ ëŒ€ìˆ˜ì  êµ¬ì¡°ë¥¼ ë°°ì›Œë´…ì‹œë‹¤!<br><br>
      
      <strong>ì•ìœ¼ë¡œ ë°°ìš¸ ê²ƒë“¤:</strong><br>
      â€¢ <strong>ë§ˆê·¸ë§ˆ</strong>: ì§‘í•© + ë‹«í˜€ìˆëŠ” ì´í•­ ì—°ì‚°<br>
      â€¢ <strong>ì„¸ë¯¸ê·¸ë£¹</strong>: ë§ˆê·¸ë§ˆ + ê²°í•©ë²•ì¹™<br>
      â€¢ <strong>ëª¨ë…¸ì´ë“œ</strong>: ì„¸ë¯¸ê·¸ë£¹ + í•­ë“±ì›<br>
      â€¢ <strong>ê·¸ë£¹</strong>: ëª¨ë…¸ì´ë“œ + ì—­ì›<br>
      â€¢ <strong>ë§, í•„ë“œ</strong>: ë‘ ê°œì˜ ì—°ì‚°ì„ ê°€ì§„ êµ¬ì¡°<br><br>
      
      ê°ê°ì€ ì´ì „ êµ¬ì¡°ì— í•˜ë‚˜ì˜ ê·œì¹™ì„ ì¶”ê°€í•œ í˜•íƒœì…ë‹ˆë‹¤!
    `
  };
  
  const playgroundCode = `// ì‹¤ìŠµ: ë‹¤ì–‘í•œ ì§‘í•©ê³¼ ì—°ì‚° ì‹¤í—˜í•´ë³´ê¸°

// 1. ìœ í•œ ì§‘í•© ì •ì˜
type Color = "red" | "green" | "blue";
type Size = "small" | "medium" | "large";

// 2. ìƒ‰ìƒ í˜¼í•© ì—°ì‚° (ì„ì˜ë¡œ ì •ì˜)
const mixColors = (a: Color, b: Color): Color => {
  if (a === b) return a;
  if ((a === "red" && b === "blue") || (a === "blue" && b === "red")) {
    return "green"; // ë¹¨ê°• + íŒŒë‘ = ì´ˆë¡
  }
  if ((a === "red" && b === "green") || (a === "green" && b === "red")) {
    return "blue"; // ë¹¨ê°• + ì´ˆë¡ = íŒŒë‘
  }
  if ((a === "blue" && b === "green") || (a === "green" && b === "blue")) {
    return "red"; // íŒŒë‘ + ì´ˆë¡ = ë¹¨ê°•
  }
  return a; // ê¸°ë³¸ê°’
};

// 3. í¬ê¸° ë¹„êµ ì—°ì‚° (ë” í° ê²ƒ ì„ íƒ)
const largerSize = (a: Size, b: Size): Size => {
  const sizeOrder = { small: 1, medium: 2, large: 3 };
  return sizeOrder[a] >= sizeOrder[b] ? a : b;
};

// í…ŒìŠ¤íŠ¸í•´ë³´ê¸°
console.log("ìƒ‰ìƒ í˜¼í•©:");
console.log('mixColors("red", "blue") =', mixColors("red", "blue"));
console.log('mixColors("green", "green") =', mixColors("green", "green"));

console.log("\\ní¬ê¸° ë¹„êµ:");
console.log('largerSize("small", "large") =', largerSize("small", "large"));
console.log('largerSize("medium", "small") =', largerSize("medium", "small"));

// ì´ ì—°ì‚°ë“¤ì´ ë‹«í˜€ìˆë‚˜ìš”? ê·¸ë ‡ìŠµë‹ˆë‹¤!
// íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ê°€ ë³´ì¥í•´ì¤ë‹ˆë‹¤.`;
</script>

<section>
  <div class="mb-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-4">ëŒ€ìˆ˜ì  êµ¬ì¡°ì˜ ì‹œì‘ì </h2>
    <p class="text-lg text-gray-700">
      ëª¨ë“  ëŒ€ìˆ˜ì  êµ¬ì¡°ëŠ” <strong>ì§‘í•©</strong>ê³¼ <strong>ì—°ì‚°</strong>ì—ì„œ ì‹œì‘ë©ë‹ˆë‹¤. 
      íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì˜ íƒ€ì… ì‹œìŠ¤í…œì„ í†µí•´ ì´ ê°œë…ë“¤ì„ ìì—°ìŠ¤ëŸ½ê²Œ ì´í•´í•´ë´…ì‹œë‹¤.
    </p>
  </div>

  <NoteBox note={setDefinition} />
  
  <CodeExample example={setExample} />
  
  <div class="my-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-4">ì´í•­ ì—°ì‚°</h2>
    <p class="text-gray-700 mb-4">
      ì§‘í•©ì˜ ë‘ ì›ì†Œë¥¼ ë°›ì•„ì„œ ê°™ì€ ì§‘í•©ì˜ í•˜ë‚˜ì˜ ì›ì†Œë¥¼ ë§Œë“œëŠ” ê²ƒì´ <strong>ì´í•­ ì—°ì‚°</strong>ì…ë‹ˆë‹¤.
    </p>
  </div>
  
  <CodeExample example={operationExample} />
  
  <NoteBox note={closureNote} />
  
  <CodeExample example={closureExample} />
  
  <NoteBox note={whyTypeScript} />
  
  <div class="my-8 p-6 bg-blue-50 rounded-lg border border-blue-200">
    <h3 class="font-bold text-blue-900 mb-3">ğŸ”‘ í•µì‹¬ ê°œë… ì •ë¦¬</h3>
    <ul class="list-disc list-inside text-blue-800 space-y-2">
      <li><strong>ì§‘í•©</strong> = íƒ€ì… (number, string, boolean, ë¦¬í„°ëŸ´ íƒ€ì… ë“±)</li>
      <li><strong>ì´í•­ ì—°ì‚°</strong> = <code>(a: T, b: T) => T</code> í˜•íƒœì˜ í•¨ìˆ˜</li>
      <li><strong>ë‹«í˜€ìˆìŒ</strong> = íƒ€ì… ì‹œìŠ¤í…œì´ ìë™ìœ¼ë¡œ ë³´ì¥</li>
      <li>ëª¨ë“  ëŒ€ìˆ˜ì  êµ¬ì¡°ëŠ” ì´ ê¸°ì´ˆ ìœ„ì— ê·œì¹™ì„ ì¶”ê°€í•œ ê²ƒ</li>
    </ul>
  </div>
  
  <NoteBox note={algebraicStructureNote} />
  
  <InteractivePlayground 
    title="ì‹¤ìŠµ: ì§‘í•©ê³¼ ì—°ì‚° ì‹¤í—˜"
    initialCode={playgroundCode}
  />
  
  <div class="mt-8 p-6 bg-gray-50 rounded-lg border border-gray-200">
    <h3 class="font-bold text-gray-900 mb-3">ë‹¤ìŒ ë‹¨ê³„</h3>
    <p class="text-gray-700">
      ì§‘í•©ê³¼ ì—°ì‚°ì˜ ê¸°ë³¸ì„ ì´í•´í–ˆìœ¼ë‹ˆ ì´ì œ <strong>ë§ˆê·¸ë§ˆ</strong>ë¶€í„° ì‹œì‘í•´ì„œ 
      ì ì§„ì ìœ¼ë¡œ ë” ë³µì¡í•œ ëŒ€ìˆ˜ì  êµ¬ì¡°ë“¤ì„ ë°°ì›Œë´…ì‹œë‹¤. 
      ê° êµ¬ì¡°ëŠ” ì´ì „ êµ¬ì¡°ì— í•˜ë‚˜ì˜ ìƒˆë¡œìš´ ê·œì¹™ì„ ì¶”ê°€í•œ í˜•íƒœì…ë‹ˆë‹¤.
    </p>
  </div>
</section>